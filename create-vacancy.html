<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–∑–¥–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é - Mansap</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="/index.html" style="text-decoration: none; color: inherit;"><h2>üéì Mansap</h2></a>
            </div>
            <div class="nav-menu">
                <a href="/index.html">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/vacancies.html">–í–∞–∫–∞–Ω—Å–∏–∏</a>
                <a href="/profile.html">–ü—Ä–æ—Ñ–∏–ª—å</a>
                <a href="#" class="btn-outline" onclick="logout()">–í—ã—Ö–æ–¥</a>
            </div>
        </div>
    </nav>

    <div class="auth-container" style="min-height: auto; padding: 3rem 0;">
        <div class="container">
            <div class="auth-box" style="max-width: 800px;">
                <h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é</h2>
                <form id="createVacancyForm">
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ (–†—É—Å—Å–∫–∏–π) *</label>
                        <input type="text" id="titleRu" required placeholder="Java —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫">
                    </div>

                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ (“ö–∞–∑–∞“õ—à–∞)</label>
                        <input type="text" id="titleKk" placeholder="Java ”ô–∑—ñ—Ä–ª–µ—É—à—ñ">
                    </div>

                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ (English)</label>
                        <input type="text" id="titleEn" placeholder="Java Developer">
                    </div>

                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ (–†—É—Å—Å–∫–∏–π) *</label>
                        <textarea id="descriptionRu" required rows="5" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ (“ö–∞–∑–∞“õ—à–∞)</label>
                        <textarea id="descriptionKk" rows="5" placeholder="–ë–æ—Å –æ—Ä—ã–Ω–Ω—ã“£ —Ç–æ–ª—ã“õ —Å–∏–ø–∞—Ç—Ç–∞–º–∞—Å—ã..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ (English)</label>
                        <textarea id="descriptionEn" rows="5" placeholder="Detailed job description..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>–¢–∏–ø –≤–∞–∫–∞–Ω—Å–∏–∏ *</label>
                        <select id="type" required>
                            <option value="INTERNSHIP">–°—Ç–∞–∂–∏—Ä–æ–≤–∫–∞</option>
                            <option value="FULL_TIME">–ü–æ–ª–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å</option>
                            <option value="PART_TIME">–ß–∞—Å—Ç–∏—á–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å</option>
                            <option value="REMOTE">–£–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–õ–æ–∫–∞—Ü–∏—è *</label>
                        <input type="text" id="location" required placeholder="–ê–ª–º–∞—Ç—ã">
                    </div>

                    <div class="form-group">
                        <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞</label>
                        <input type="number" id="salaryMin" placeholder="100000">
                    </div>

                    <div class="form-group">
                        <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞</label>
                        <input type="number" id="salaryMax" placeholder="150000">
                    </div>

                    <div class="form-group">
                        <label>–í–∞–ª—é—Ç–∞</label>
                        <select id="currency">
                            <option value="KZT">KZT (–¢–µ–Ω–≥–µ)</option>
                            <option value="USD">USD (–î–æ–ª–ª–∞—Ä)</option>
                            <option value="EUR">EUR (–ï–≤—Ä–æ)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–¢—Ä–µ–±—É–µ–º—ã–µ –Ω–∞–≤—ã–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                        <input type="text" id="requiredSkills" placeholder="Java, Spring Boot, PostgreSQL">
                    </div>

                    <div class="form-group">
                        <label>–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã (–ª–µ—Ç)</label>
                        <input type="number" id="experienceYears" min="0" value="0">
                    </div>

                    <div class="form-group">
                        <label>–°—Ä–æ–∫ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–æ–∫</label>
                        <input type="date" id="deadline">
                    </div>

                    <div id="errorMessage" class="error-message"></div>
                    <div id="successMessage" class="success-message"></div>

                    <button type="submit" class="btn-primary" style="width: 100%;">‚ú® –°–æ–∑–¥–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é</button>
                </form>

                <div class="form-footer">
                    <a href="/profile.html">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª—å</a>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Mansap. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
    </footer>

    <script src="/js/app.js"></script>
    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
        if (!isAuthenticated()) {
            window.location.href = '/login.html';
        }

        document.getElementById('createVacancyForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const skills = document.getElementById('requiredSkills').value
                .split(',')
                .map(s => s.trim())
                .filter(s => s);

            const data = {
                titleRu: document.getElementById('titleRu').value,
                titleKk: document.getElementById('titleKk').value || null,
                titleEn: document.getElementById('titleEn').value || null,
                descriptionRu: document.getElementById('descriptionRu').value,
                descriptionKk: document.getElementById('descriptionKk').value || null,
                descriptionEn: document.getElementById('descriptionEn').value || null,
                type: document.getElementById('type').value,
                location: document.getElementById('location').value,
                salaryMin: parseFloat(document.getElementById('salaryMin').value) || null,
                salaryMax: parseFloat(document.getElementById('salaryMax').value) || null,
                currency: document.getElementById('currency').value,
                requiredSkills: skills,
                experienceYears: parseInt(document.getElementById('experienceYears').value) || 0,
                deadline: document.getElementById('deadline').value || null
            };

            try {
                const response = await fetch(`${API_URL}/vacancies`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${getToken()}`
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    showSuccess('successMessage', '–í–∞–∫–∞–Ω—Å–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...');
                    setTimeout(() => {
                        window.location.href = '/profile.html';
                    }, 2000);
                } else {
                    const error = await response.json();
                    showError('errorMessage', error.message || '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–∏');
                }
            } catch (error) {
                console.error('Error creating vacancy:', error);
                showError('errorMessage', '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
            }
        });
    </script>
</body>
</html>
